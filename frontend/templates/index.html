{% extends 'base.html' %} {% block content %}
<div class="bg-white rounded-lg shadow p-4">
  <div class="items-center">
    <img
      src="{{ url_for('static', filename='images/PSC-logo-resize.png') }}"
      alt="PSC Logo"
    />
  </div>
  <div class="text-center w-full mt-4">
    <h2 class="text-lime-600">OEE Real-time monitoring</h2>
  </div>
  <div class="max-w-7xl mx-auto mt-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="bg-gray-200 rounded-lg shadow p-6 text-center">
        <h2 class="text-gray-600">Availability (A)</h2>
        <div id="radialA"></div>
      </div>
      <div class="bg-gray-200 rounded-lg shadow p-6 text-center">
        <h2 class="text-gray-600">Performance (P)</h2>
        <div id="radialP"></div>
      </div>
      <div class="bg-gray-200 rounded-lg shadow p-6 text-center">
        <h2 class="text-gray-600">Quality (Q)</h2>
        <div id="radialQ"></div>
      </div>
    </div>

    <div class="bg-gray-200 rounded-lg shadow p-6 mb-8">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">OEE Overview</h2>
      <div id="oeeChart"></div>
    </div>

    <div class="bg-gray-200 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">
        OEE Trend (Last 7 Days)
      </h2>
      <div id="oeeLineChart"></div>
    </div>
  </div>

  <script>
    // RadialBar Chart
    var radialOptions = {
      chart: {
        type: "radialBar",
        height: 350,
      },
      series: [76],
      labels: ["OEE"],
      colors: ["#3B82F6"],
      plotOptions: {
        radialBar: {
          hollow: { size: "60%" },
          track: { background: "#ffffff", strokeWidth: "100%" },
          dataLabels: {
            name: {
              offsetY: -10,
              color: "#4B5563",
              fontSize: "18px",
            },
            value: {
              fontSize: "28px",
              color: "#111827",
              offsetY: 10,
            },
          },
        },
      },
    };
    new ApexCharts(document.querySelector("#oeeChart"), radialOptions).render();

    // Function to create A P Q charts
    function createRadialChart(id, value, color) {
      var options = {
        chart: { type: "radialBar", height: 250 },
        series: [value],
        plotOptions: {
          radialBar: {
            hollow: { size: "60%" },
            track: { background: "#ffffff", strokeWidth: "100%" },
            dataLabels: {
              name: { show: false },
              value: {
                fontSize: "22px",
                fontWeight: "bold",
                color: "#111827",
                offsetY: 6,
                formatter: (val) => val + "%",
              },
            },
          },
        },
        colors: [color],
      };
      new ApexCharts(document.querySelector(id), options).render();
    }

    // ✅ Create A, P, Q charts
    createRadialChart("#radialA", 92, "#3B82F6");
    createRadialChart("#radialP", 87, "#10B981");
    createRadialChart("#radialQ", 95, "#8B5CF6");

    // Line Chart
    var lineOptions = {
      chart: {
        type: "line",
        height: 350,
        zoom: { enabled: false },
      },
      series: [
        {
          name: "OEE %",
          data: [78, 82, 80, 76, 79, 81, 84], // ตัวอย่างข้อมูล OEE 7 วัน
        },
      ],
      xaxis: {
        categories: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
        title: {
          text: "Day",
        },
      },
      yaxis: {
        min: 0,
        max: 100,
        title: {
          text: "OEE (%)",
        },
      },
      stroke: {
        curve: "smooth",
      },
      colors: ["#10B981"], // Tailwind green-500
    };
    new ApexCharts(
      document.querySelector("#oeeLineChart"),
      lineOptions
    ).render();
  </script>
</div>
{% endblock %}
